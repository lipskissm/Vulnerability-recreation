#!/bin/bash

# Define the content of routing.sh
ROUTING_CONTENT="#!/bin/bash
check_internet_connection() {
    wget -q --spider http://google.com
    return $?
}
while ! check_internet_connection; do
    sleep 1
done

ip_address=\$(ip a show dev eth0 | grep -oP 'inet \\K\\S+' | cut -d'/' -f1)

file_path=\"/var/www/html/wp-config.php\"

line_number=\$(\$(wc -l < \"\$file_path\") - 2)

{
    head -n \"\$line_number\" \"\$file_path\"
    echo \"define('WP_SITEURL', 'http://\$ip_address');\"
    echo \"define('WP_HOME', 'http://\$ip_address');\"
    echo \"\"
    tail -n 2 \"\$file_path\"
} > temp_file && mv temp_file \"\$file_path\""

# Create the routing.sh file
echo "$ROUTING_CONTENT" > routing.sh

# Move the file to usr/local/bin
sudo mv routing.sh /usr/local/bin

# Set permissions to make it executable
sudo chmod +x /usr/local/bin/routing.sh
